# Aula 14/12/2021

## Gerenciamento de Conexão TCP: three-way handshake

- Flag ACK, SYN e FIN

### solicitação de conexão
- Manda pacote de solicitação com o flag SYN  = 1
    - Pode aceitar ou recusar. 
- Se aceitar retorna SYN = 1 e ACK = 1
- então o solicitante manda outro pacote com ACK = 1
 
### solicitação de encerramento de conexão
- Manda pacote com FIN = 1
- O receptor manda um ACK e depois solicita também um fechamento com o FIN = 1
- O solicitante então recebe um ACK = 1 e espera um tempo antes de fechar para receber eventuais pacotes e descartá-los sem gerar mensagens de erro.

## Controle de Congestionamento

- geralmente as perdas de dados em enlaces por fio (fibra óptica) acontece por congestionamento
- reduzir a emissão de dados porque pacotes estão sendo perdidos.

### Controle de congestionamento do TCP
- controle fim-a-fim
- janela de congestionamento (congWin): é dinâmico, função de congestionamento das redes detectadas.

#### 3 mecanismos
- TCP AIMD: 
    - redução multiplicativa: diminui o CongWin pela metade após o evento de perda
    - aumento aditivo: aumenta o CongWin com 1 MSS (Maximum Segment Size) a cada RTT
    - curva dente-de-serra
- TCP: Partida lenda
    - Começa com a janela em 1
    - A cada confirmação ele manda um segmento a mais; 1 -> 2 -> 4 -> 8 -> 16 ...
        - crescimento exponencial nos casos de sucesso.
        - utiliza threshold como lineares "limitadores", após o limitador, o crescimento de pacotes é linear de 1 em 1 a cada envio.
	- Se ocorrer erro no envio de pacote, na primeira variante do TCP reduzia a janela pra 1. Mas na variante 2, ele recalcula um novo threshold, dividindo o ponto de parada por 2 e partindo de 1 novamente.
	- variante com retransmissão rápida: reenvia o pacote antes do timeout com solitação repetida, utiliza o threshold (n/2) e continua nesse tamanho de janela.

# Camada de Rede

- Transporta segmentos entre hospedeiros
- No lado transmissoe encapsula os segmentos em datagramas IP
- No lado receptor, entrega os segmentos à camada de transporte
- Protocolos da camada de rede em cada hospedeiro e roteador
- Roteador examina campos de cabeçalho em todos os datagramas IP que passam por ele